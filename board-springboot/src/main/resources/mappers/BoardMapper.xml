<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.myboard.mapper.BoardMapper">

<sql id="boardColumns">
      idx
    , title
    , content
    , writer
    , view_cnt
    , notice_yn
    , secret_yn
    , delete_yn
    , insert_time
    , update_time
    , delete_time
</sql>

<!-- 게시글 생성 -->
<insert id="insertBoard" parameterType="BoardDTO">
    insert into BOARD_TABLE (
        <include refid="boardColumns" />
    ) values (
         BOARD_TABLE_SEQ.NEXTVAL
       , #{title}
       , #{content}
       , #{writer}
       , 0
       , NVL(#{noticeYN, jdbcType=VARCHAR}, 'N')
       , NVL(#{secretYN, jdbcType=VARCHAR}, 'N')
       , 'N'
       , sysdate
       , null
       , null
    )
</insert>

<!-- 게시글 목록 -->
<select id="selectBoardList" parameterType="BoardDTO" resultType="BoardDTO">
    SELECT
        <include refid="boardColumns" />
    FROM
        board_table
    WHERE
        delete_yn = 'N'
    ORDER BY
        notice_yn ASC,
        idx DESC,
        insert_time DESC
</select>

<!-- 게시글 개수 -->
<select id="selectBoardTotalCount" parameterType="BoardDTO" resultType="int">
    SELECT
        COUNT(*)
    FROM
        board_table
    WHERE
        delete_yn = 'N'
</select>

<!-- 게시글 조회 -->
<select id="selectBoardDetail" parameterType="long" resultType="BoardDTO">
    SELECT
        <include refid="boardColumns" />
    FROM
        board_table
    WHERE
        delete_yn = 'N'
    AND
        idx = #{idx}
</select>
</mapper>